CHANGELOG file for CrisoftRicette


v. 1.0pre15b "Uffa!" released on 06.03.2003
-------------------------------------------

6.03.2003

search.php: added an error message if search term does not match to 
any recipe into database and a message that a number of recipes were found
if search terms match.

recipe.php: removed a curly brace in excess at line 349 that blocks page 
display.

admin_07import.php: hostname check is performed on a wrong $_POST key.
Fixed.


v. 1.0pre15a "Mannaggia la pupazza" released on 05.03.2003
----------------------------------------------------------

5.03.2003
login.php: the if cycle at line 28 and below is broken. Fixed.


v. 1.0pre15 "Roll the bones" released on 04.03.2003
---------------------------------------------------
4.03.2003
crisoftlib.php: calls to non existing cs_AddInstallHeader() functions
prevented correct working of the application. Renamed to cs_AddHeader().
Fixed.

2.03.2003
trans_sid ware code has been rewritten in a shorter form for all scripts
but where URI is passed through header() function.

admin_modify.php: & character missing from pagination link (previous
page) with trans-sid disabled. Fixed.

search.php: search.php script is called passing parameters with &
instead of ?
Fixed.

1.03.2003
includes/header.inc.php: added link to admin_index.php

crisoftlib.php: missing trans_sid checking code in
cs_PrintModifyTable(). Fixed.

recipe.php: changed parameters of image output in pdf format in order to
prevent problems with big images.

admin_index.php and includes/header.inc.php: added link to admin_mmedia.php

admin_mmedia.php: this script lets you add image/video if previously not
entered. Administrator check is performed in order to avoid data entry
from non-administrator.

27.02.2003

admin_mmedia.php. added script to package.

crisoftlib.php: if image and/or video are missing from a recipe a link
to admin_mmedia.php is printed.

v. 1.0pre14 "NO WAR!" released on 26.02.2003
-------------------------------------------------
25.02.2003
admin_delete.php: added a missing curly brace in code used to calculate
number of pages.

23.02.2003
Scripts modified to carry on session also with PHP installation without
--enable-trans-sid support:
admin_07import.php admin_backup.php admin_config.php admin_cook.php
admin_logout.php admin_userpass.php admin_restore.php
admin_optimize.php admin_modify.php admin_delete.php admin_dish.php
admin_export.php admin_import.php admin_index.php admin_insert.php

admin_07import.php: added missing double quote character in referer page
link.

crisoftlib.php: cs_ConfigValueEmpty() did not destroy the session.
Fixed.
Added cs_AdminFastLogout() to print fast logout from admin area link.

22.02.2003

Scripts modified to carry on session also with PHP installation without
--enable-trans-sid support:
login.php browse.php search.php cookbook.php mail.php rate.php
recipe.php shoppinglist.php

crisoftlib.php: added cs_IsTransSid() function to determine if
enable_trans_sid feature is available to enable SID echo in links output
if this feature is not available.

browse.php: changed references to graphics/  into layout/ subdir.

graphics/ subdirectory name has been changed into layout/

mail.php: if sender email address session variable is empty or unset the
script aborts with error.

21.02.2003
language.php: now the script checks for register_globals = On in php.ini
and if found aborts with error.

20.02.2003
crisoftlib.php: removed following functions since they are no more used:
cs_CheckEmailAddress()
cs_CheckEmptyValue()
cs_DefaultData()

includes/db_connection.inc.php: internationalized three missing program 
messages.

18.02.2003

includes/: removed unused files.

db_connection.inc.php: rewritten using the same header system.

crisoftlib.php: removed cs_AddInstallHeader(), cs_AddErrorHeader(),
cs_AddAdminHeader() obsolete functions.

includes/header.inc.php: rewritten in order to have only one included
file to manage different headers for different script types.

admin_login.php renamed to login.php

17.02.2003

Added lang/hu.php, hungarian message file (partial translation) made by
Miklos Bagi Jr. <joschy@mbjr.dyndns.org>


v. 1.0pre13 "Counterparts" released on 14.02.2003
-----------------------------------------------

13.02.2003

README in main application directory tells to look into docs/README.

Created docs/ subdirectory to store all documentation files and moved
files into it. and moved files into it.
Removed export plugin for Cookbook Wizard for Windows since this
application can use MealMaster format and it does not show at this time
a consistent file format.

admin_insert.php: form checks rewritten in order to redisplay input form
for required fields left empty or dangerous inputs.

crisoftlib.php: added cs_PrintInsertRecipeForm(), cs_PrintInsertRecipeFormDanger()
and cs_PrintInsertRecipeFormDangerNS() to manage redisplaying of recipe
input form in case of resp. missing required data, dangerous input data
and dangerous input data for fields that may contain slashes and
backslashes.

12.02.2003

language.php, admin_config.php: a regular expression drops invalid
language filenames.

08.02.2003

Updated. FAQ, README and INSTALL file.

TRANSLATIONS: file updated reflecting the new translation scheme.

admin_modify.php: form check rewritten in order to redisplay input form
for required fields left empty or dangerous inputs.

admin_cook.php: cooking type input checks rewritten to redisplay form in
case of error (empty or invalid characters input)

recipe.php: generated PDF is now internationalized.

admin_config.php: email checking rewritten to redisplay input form in
case of a illegal email address.

crisoftlib.php: added cs_CheckEmptyInputConfig() and 
cs_CheckDangerousInputConfig() functions to respectively check for empty
fileds and potentially dangerous characters in admin_config.php. If
found both functions will redisplay input form without processing it.

search.php: the script now redisplays form with email address input if
error condition is met.

mail.php: the script now redisplays form with email address input if
error condition is met.

Fixed some html code in all scripts (example: <p class=error> without
double quotes)

admin_config.php: hostname checking routine performed the check on a
wrong POST variable. Fixed.

install.php: if during installation one or more input fields are left
blank the script now prints again the form asking to fill in required
missing data.

crisoftlib.php: Added cs_CheckEmptyValueInstall() function, that checks 
if all required values are present, in case of error the form is redisplayed.
Added cs_PrintInstallationForm() function to print installation
form in case of some installation errors.


07.02.2003

Internationalization: english and italian language files are fully available.

06.02.2003

Except language selection, all installation procedure is fully internationalized.

install.php: routine that checks for valid locales has been moved on the top of 
the script, immediately after parsing installation switch.

index.php: if application is not installed (config file not found) language.php 
is called instead of install.php.

language.php: added file to package. This file will be the first file called 
if the application is not installed. From here you can choose your preferred
language so you'll enjoy installation process into selected language.

04.02.2003
install.php: routine that checks for tampered locale settings has been
rewritten to follow the new internationalization system.

02.02.2003

crisoftlib.php: removed cs_ReadVersionFile().

import.php, recipe.php, export.php: plugin definition is now read
through an include().

definition.php: for all plugins definition name is assigned to a
variable in order to avoid displaying data if file is directly 
called from browser.

insert.php: removed script. From now on it's possible to insert recipes
only from admin area.

admin_insert.php: added new script to insert recipes from admin area.

New internationalization scheme for admin_modify.php, includes/header_admin.inc.php,
includes/header_logout.inc.php, admin_backup.php, admin_restore and
admin_userpass.php.
Migration to new internationalization scheme has been completed, except
for install.php that needs to be partially rewritten.

01.02.2003

includes/footer.inc.php: link to GPL license terms has been modified to
call license.php

license.php: added file to package.

install.php, index.php, admin_config.php: removed the call to
cs_ReadVersionFile() and recplaced with an include() of version.php.

version.php: version number is now assigned to the variable $sw_version
in order to avoid displaying data if this file is directly called from
browser.

New internationalization scheme for admin_delete.php, admin_dish.php,
admin_export.php

admin_dish.php: when trying to insert duplicate serving name the scripts now prints
a new empty form after the error message in order to avoid going back
with the browser.
If serving name contains dangerous input the scripts now prints
a new empty form after the error message in order to avoid going back
with the browser.
Fixed some typos in application messages that referred to cooking types
instead of servings.

31.01.2003
New internationalization scheme for admin_07import.php admin_config.php
and admin_cook.php

admin_config.php: added hostname check.

admin_cook.php: if user enters an already existing cooking type, the scripts now prints
a new empty form after the error message in order to avoid going back
with the browser.

30.01.2003
New internationalization scheme for all currently available export/import plugins.

29.01.2003
admin_login.php: fixed some typos in html code (closing table rows tags)

New internationalization scheme: search.php, shoppinglist.php, admin_login.php, admin_index.php ready.

28.01.2003
New internationalization scheme: mail.php, rate.php ready.

27.01.2003
admin_07import.php: added mysql_escape_string() to all data retrieved
from 0.7.x database in order to prevent problems with characters not
MySQL friendly.

26.01.2003
New internationalization scheme: cookbook.php, export.php and insert.php
ready.

25.01.2003
New internationalization scheme: index.php, browse.php, crisoftlib.php,
logout.php and recipe.php ready.

crisoftlib.php: removed cs_CheckForLocale() function.

browse.php: added arrow.gif to layout.

admin_config.php: script now reads available translation files in lang/
subdirectory.  

index.php: removed language session variable. Script now reads available 
translation files in lang/ subdirectory. 

install.php: script now reads available translation files in lang/
subdirectory. Changed description of locale keyword in INI file.

lang/: added empty en.php and it.php language files to test new
translation scheme for installation procedure.

22.01.2003

Removed all references to gettext in documentation files: README,
INSTALL and FAQ.

Added subdirectory lang/ to store all language files.

Removed all gettext code from entire project: ready to implement new
internationalization scheme.


v. 1.0pre12 "Lou Dalfin" released on 21.01.2003
-----------------------------------------------
19.01.2003

install.php: PHP version requirements downgraded to 4.2.1 even if this
release suffer a major security bug.

install.php: added fr_FR, fr_CH and fr_BE locales missing from last
prerelease.

admin_index.php: new menu layout.

admin_optimize.php: added this script to optimize (compact) database,
useful when doing continous adding/deleting recipes in order to prevent
inefficient database management.

plugins/mealmaster/import.php: added script to package. This script will
let you import into CrisoftRicette main database recipes from
MealMaster file format.

plugins/mealmaster/export.php: fixed a missing space in export filter
between the two newline/carriage return before recipe description.

plugins/dbricette/import.php: added script to package. This script will
let you import into CrisoftRicette main database recipes from
dbricette.it/Bekon Idealist Natural file format.

18.01.2003

admin_import.php: added file to package. The script scans plugins
subdirectory for available import scripts.

browse.php: fixed some various missing exit()
calls at the end of every browsing type routines.

crisoftricette.css: added specific classes to <p> tag for normal and
admin menus.

header_admin.php: added file to package into includes/ subdir
with specific menu for admin area.

crisoftlib.php: added cs_AddheaderAdmin() function to add a specific
menu header for all admin pages.

admin_restore.php: completely modified restore routine since previous
version tried to execute queries even after end of sql file.

admin_modify.php: modified input checking code in order to use 
cs_CheckDangerousInputNoSlash() for time, description and ingredients 
input fields.

insert.php: modified input checking code in order to use 
cs_CheckDangerousInputNoSlash() for time, description and ingredients 
input fields.

crisoftlib.php: added function cs_CheckDangerousInputNoSlash.
This function works the same way of cs_CheckDangerousInput() but does
not consider slash and backslash characters as dangerous ones, in order
to permit to insert fractions for ingredients, description and time
recipe fields.


12.01.2002

Some updates in INSTALL, README and FAQ files.

admin_restore.php: the scripts takes backup/crisoftricette.sql and restores 
database from this file.

admin_backup.php: added str_replace() on ingredients, description and notes retrieved
from main table and ingredients from shopping table since carriage return characters 
cause errors in SQL statements.

admin_backup.php: added addslashes() to most of text retrieved from database when
doing backup.

admin_backup.php: fixed a typo in DROP TABLE IF EXIST sql statement. (it should
be EXISTS...)

admin_backup.php: a sql file, named crisoftricette.sql, is saved into backup 
subdirectory. 
This file can be used from command line with mysql to restore database or with
the appropriate restore function yet to be added to CrisoftRicette.

Added backup/ subdirectory to package: this directory is going to store all SQL 
backups.

admin_backup.php and admin_restore.php: added these script to deal with 
backup/restore of entire database. The script are accessible from 
admin_index.php.

insert.php: it's now possible to add a videoclip to a recipe.

admin_07import.php: all form input fields have security checks.


v. 1.0pre11 "Happy New Year" released on 10.01.2003
---------------------------------------------------

10.01.2003
Moved software status from ALPHA to BETA since I think that it is a
little bit more stable and usable.

includes/db_connection.inc.php: changed connection type to mysql server
from normal to persistent in order to prevent any problems in admin_07import.php
since two connections of same type can't coexist in the same script.

includes/db_connection.inc.php: changed connection type to mysql server
from normal to persistent in order to prevent any problems in admin_07import.php
since two connections of same type can't coexist in the same script.

admin_07import.php: a basic import from 0.7.x feature is working.

09.01.2003
admin_07import.php: added this page that should allow to import existing recipes
of CrisoftRicette 0.7.x into 1.0.

02.01.2003

Added a test french language support thanks to Patrick Voivenel. This message 
file is from 1.0pre9 so french support is only partial. Please be warned that 
translation should be fitted to context.

admin_export.php: select form box code updated in order to include only really 
existing filters. Cookbook Wizard export filter is now disabled.

recipe.php: select form box code updated in order to include only really 
existing filters. Cookbook Wizard export filter is now disabled.


31.12.2002

crisoftlib.php: removed cs_TableCheck, cs_TableExists and cs_TableHasData 
functions since they are no more used by install.php (buggy functions).

crisoftlib.php:
When dish table is empty you will get following error if you call modify action:
Notice: Undefined variable: list_data in [...]/crisoftlib.php on line 605
Warning: Invalid argument supplied for foreach() in [...]/crisoftlib.php on line 606
This has been fixed starting the routine only if there is at least one record 
into table.

crisoftlib.php:
When cooking type table is empty you will get following error if you call modify
action:
Notice: Undefined variable: list_data in [...]/crisoftlib.php on line 576
Warning: Invalid argument supplied for foreach() in [...]/crisoftlib.php on line 577
This has been fixed starting the routine only if there is at least one record 
into table.

install.php: database and table creation routines has been completely rewritten in order
to remove various problems when reinstalling software with already existing database 
and tables. Added a check to admin username and password in order to avoid using a password
identical to username for security reasons.
With previous version there was the possibility to insert into the admin table more than one 
user/password combination: this has been fixed and from now on only one record is allowed
into this table: install.php script takes care about it, checking number of records into
the table, deleting all if more than one and replacing with the one submitted through
the installation form.

30.12.2002

crisoftlib.php: added an exit() to cs_TableExists.
Added cs_TableCheck() function.

All available export plugins now are able to export entire main table or a single 
recipe. PLEASE DO NOT USE Cookbok Wizard EXPORT FILTERS SINCE IT'S BUGGED AND DOES 
NOT PRODUCE A VALID .CW FILE! This warning appears into definiton file and is displayed
on screen.

export.php: added this script to manage single recipe export in other file
formats.

Export main table feature now works with plugin system with following plugins:
- plain ASCII text
- dbricette.it Bekon Idealist Natural
- CSV (useful for spreadsheets)
- MealMaster for DOS
- Cookbook Wizard for Windows, even if this filter is bugged - please use MealMaster
instead of this one.

plugins/csv/: added definition.php to store type definition of exported
file and export.php with routines to export full main table and a single recipe.

admin_export.php: Fully rewritten since I have decided to implement 
a plugin system to export/import entire main table or single recipe 
to/from different file formats.

Created plugins/ subdirectory tree to hold all export/import
plugins. All already written and working export routines has been
moved into plugins.

29.12.2002

admin_export.php: added a routine to export entire database into
CookbookWizard for Windows file.

admin_export.php: str_replace() called on description and ingredients
field in order to remove carriage return sequences to have a properly
formatted MealMaster file.

admin_export.php: fixed export to CSV file.
A basic routine to export into MealMaster file format has been added but
should be tested.


28.12.2002

admin_export.php: you can now export entire main table in plain text
format and dbricette.it format (Bekon Idealist Natural). CSV export
routine, even if working, should go under accurate testing since
exported file causes an error with Gnumeric (the GNU spreadsheet).

header*.inc.php: added two http headers in order to reload page from
webserver instead of browser or proxy cache since some problems may
arise with Squid proxy.

crisoftlib.php: added cs_CheckDefaultAdmin() fucntion to check if user
leaves default admin/admin pair as username and password.

install.php: added inputs to installation form to insert admin username
and password.

After a short hiatus due to Christmas period, finally I am back to work
on CrisoftRicette :-)

13.12.2002

Added directory export to package: this directory will contain exported lists.
This directory is world writable in order to let the webserver write into it.

admin_index.php: added link to admin_export.php

admin_export.php: added file to package. From this script it's possible to 
export recipes to several file formats when complete.

install.php: changed layout of html form.

install.php: fixed undefined variable num_data_rows on lines 292 and 302


v. 1.0pre10 "Santa Lucia" released on 13.12.2002
------------------------------------------------

12.12.2002
admin_index.php: fixed a warning caused by an undefined index if this
script is called directly without logging in.

install.php: added a check for presence of all application scripts. If
this check fails installation process will abort.

install.php: default data are inserted into admin and difficulty tables only if 
cs_TableHasData() tells that these tables are empty.

crisoftlib.php: added cs_TableHasData() that performs a check if a table
has already data into.

admin_login.php: added a simple routine that performs a check for default username and password
for administrator. If they are as default a warning will be displayed.

11.12.2002

FAQ: updated file.

INSTALL: updated file adding some tips to installation procedure.

README: updated file.

admin_config.php: added security checks and select boxes for available locales and PDF page sizes

crisoftlib.php: added cs_CheckForLocale() function to check for legal locale values.

admin_index.php: added link to admin_modify.php

admin_config.php: added script to modify setup parameters. The script basically let you change configuration 
parameters and works, even it needs security checks and some enhancements.

10.12.2002
recipe.php: PDF generation routine completed. Before generation the script checks 
for presence of image into database and depending of this it call a different
PDF generation routine.

8.12.2002
recipe.php: PDF generation now outputs also an image of the recipe (if
inserted into database and only if .jpg or png)

6.12.2002
crisoftlib.php: removed cs_CheckForPDF() function.

recipe.php: it now generates a basic PDF file of selected recipe even if
PDF functions are not available under your PHP installation.
PDF generation routine with PHP's own PDF function has been removed.

5.12.2002
Added fpdf.php script and font subdirectory directly from fpdf package.
fpdf should replace PHP pdf routines in order to avoid the needing of
PHP's PDF own functions to be available.

4.12.2002

insert.php: moved preview action to ins_preview

admin_*.php: all actions renamed to adm_*

admin_cook.php: added fast logout option where missing.

logout.php: the script now checks for empty $_SESSION scope and if true
ti loads index.php. This should prevent problems if logout.php is called
directly.

browse.php: all actions renamed to br_* 

cookbook.php: all actions renamed to cook_*

rate.php: all actions renamed to v_*

recipe.php: add to shopping list moved to POST method. Add to shopping
list action renamed to sl_add, other actions renamed to rec_*

shoppinglist.php: print action moved to POST scope. Removed id passing
from print form and from code that displays printer friendly version 
since is not useful. Delete action moved to POST scope. You now need to
ckick on delete button to perform deletion from shopping list.
All form actions are renamed adding sl_ prefix to them (sl_add, sl_print
and sl_delete).

install.php: removed all gettext code since it will never be used.
In the case you are fully reinstalling the application, now the script 
checks if default admin data are into corresponding table and sets default 
values only if not found.


v. 1.0pre9 released on 3.12.2002
---------------------------------
3.12.2002
messages.po: updated italian translation

TRANSLATIONS: updated

FAQ: added a few Frequently Asked Questions

1.12.2002

messages.po: generated new file for international messages.

admin_index.php: username and password input checks for dangerous characters moved to appropriate cs_CheckDangerousInput() function.

admin_userpass.php: added secutiry checks to form fields before passing data to mysql.

admin_insert_dish.php and admin_insert_dish_ok.php removed from package since they have been merged into admin_dish.php.

admin_dish.php: added to package with the content of admin_insert_dish.php and admin_insert_dish_ok.php

browse.php, rate.php, mail.php, insert.php, index.php, cookbook.php, recipe.php, search.php: added
cs_DestroyAdmin() function in order to unset admin username and password from session variables even if admin doesn't logout properly from admin section.

admin_userpass.php: added to package. This script let you modify username and password for administrator.

admin_cook.php: modify and delete a cooking typ completed.

admin_logout.php: unsetting of admin user and pass session varibales is now performed by
cs_DestroyAdmin() function. Added require() for function library file.

crisoftlib.php: added cs_PrintCookingTable() to print list of available cooking types to let them modify/delete in admin_cook.php
added cs_DestroyAdmin() to destroy admin/user pass stored into $_SESSION.

admin_index.php: added a check t the beginning of the script for admin user/pass session variables. If not set the script does required checks for admin_login.php form input fields.

admin_login.php: if admin username and password are stored in session variables, login form is not printed and admin is transported to admin_index.php script.

admin_cook.php: corrected a typo at line 52 (missing "e" character in $_POST['cooking_category']
variable when SQL fails to check for duplicate cooking type names). mysql_error() is now on the same line that outputs the SQL error message.

admin_insert_cook*.php: merged into admin_cook.php ad deleted from package.

admin_cook.php: new file created.

29.11.2002

INSTALL and README: documentation files revised to follow development.

admin_delete.php: added file to delete single recipes from database. Fully working.

crisoftlib.php: added cs_AlphaLinksDel() and cs_PrintDeleteTable() to be used into admin_delete.php script

admin_modify.php: the script now let you completely modify a recipe already into database preserving id
number, and after having modified it prints out data in the same way as recipe.php does.

insert.php: added cs_CheckDangerousInput() to check form input for dangerous characters

crisoftlib.php: removed space chraracte from regular expression into cs_CheckDangerousInput() function

28.11.2002
admin_modify.php: script now displays recipe list and retrieve data of selected recipe.

crisoftlib.php: added cs_AlphaLinksMod() and cs_PrintModifyTable() used in admin_modify.php

browse.php: modified link to recipe modification page.

admin_modify.php: added file to package, actually empty.

browse.php: if database does not contain any recipe the script will print an error message 
instead of search form.

search.php: if database does not contain any recipe the script will print an error message 
instead of search form.

index.php: added deleting of old configuration file if database name configuration keyword
refers to an unexisting database.

27.11.2002
Added a FAQ file (even if actually empty)

crisoftlib.php: removed all gettext activation code from cs_CheckForGettext()
and added suggestion to download the nongettext release if gettext is not 
supported as alternative

install.php: PHP version check moved at the very beginning of the file.
Moved cs_CheckForGettext() call immediately before require() of library
file.


v. 1.0pre8 released on 22.11.2002
---------------------------------
22.11.2002
messages.po: generated a new messages file

21.11.2002

Fixed some gettext activation characters sequences (see BUGS file for 
details).

crisoftlib.php: modified cs_PrintRecipeData(). It now performs data
retrieving from database with mysql_fetch_array() instead of
mysql_fetch_object() and data are displayed in a table with alternate
rows colors.

20.11.2002
crisoftlib.php: added cs_PrintRecipeData() function to print all recipe
details into a table.

TRANSLATIONS: added spanish translator email.

INSTALL: created moving installation instructions from README
file.

17.11.2002

cookbook.php: the cookbook content is now displayed through
cs_PrintCookbook() function. recipes in cookbook are now counted by
cs_CountCookbook() function.

crisoftlib.php: added cs_CountCookbook() function, used to count number
of recipes into personal cookbook. Added cs_PrintCookbook() to print
cookbook list with alternating colors for table rows.

recipe.php: text for form buttons has been shortened.

16.11.2002

crisoftlib.php: added cs_PrintBrowseTable(), cs_PrintBrowseTableDifficulty()
and cs_PrintBrowseTableParameter(). These three new functions are used
to print browse tables with alternating colors for table rows.

browse.php: begin to code alternating table rows colours. Some problems
have yet to be faced and solved before finishing it. Actually does not
work, implemented only for id browsing.

crisoftlib.php: added cs_CountRowsRecipePage(). This function counts the
number of recipes printed on a single browse page, and the result will
be used to print table rows with alternating colours.

browse.php: added cs_AlphaLinks() call to alphabetical order browse. 
Added code to print list with selected letter.

crisoftlib.php: added cs_AlphaLinks(). This function will print the full
list of alphabet letters, and this list is clickable to access all
recipes beginning with a letter.
Modified cs_CheckForBrowseType() adding "letter" value to security
check.


v. 1.0pre7 released on 14.11.2002
---------------------------------
13.11.2002

crisoftlib.php: renamed cs_ReadFile() into cs_ReadVersionFile()

crisoftlib.php: modified cs_ReadFile(). This function should accept as
parameter only filename WITHOUT slashes. Stripped carriage return with
substr() to avoid copying it in session value.

browse.php: difficulty grade of the recipe is now printed with
asterisks (only for browsing by ascending o descending difficulty grade)

recipe.php: difficulty grade of the recipe is now printed with
asterisks.

install.php: removed ctype_alnum() on database username since this
function seems not to be supported under full install of PHP 4.2.2 for
Windows. All installation form fields are checked against malicious
input.

All filenames with mixed case are now only lowercase in order to
prevent problems on non case sensitive operating systems. This means
that CrisoftLib.php, CrisoftRicette.css and CrisoftRicette.ini.php have
now filenames only in lowercase (crisoftlib.php and so on).
Also session name has been changed into lowercase.

10.11.2002

README: updated reflecting new features; corrected some unclear
statements.

search.php: created search page. It performs searches of one or more
space-separated keywords on one or multiple database fields.

CrisoftLib.php: added cs_CheckForGD() to check for GD support in PHP
installation, even if not yet called from main application. For future
use. Added cs_CheckDangerousFormField() to check for trivial exploit in
form fields and cs_CheckEmptyFormField() to check for empty required
form fields.

recipe_print.php: merged into recipe.php and removed from package.

recipe.php: moved cs_AddHeader() function immediately after all
$_POST['action'] checks.

recipe_pdf.php: merged into recipe.php and removed from package.

rated.php: merged into rate.php and removed from package.

recipe.php: link to all features has been changed into form buttons.

browse.php: replaced old code with include() statement for footer file 
with cs_AddFooter() function.

index.php: added a check for empty values in configuration parameter. If
found the called function will ask to restart installation process.

CrisoftLib.php: added cs_EmptyConfigValue() to check for existance of
configuration parameters.

v. 1.0pre6 released on 8.11.2002
--------------------------------
7.11.2002

messages.po: generated an updated messages file.

Fixed some typing errors in various scripts.

CrisoftLib.php: added cs_ReadFile() to read a file from disk and putting
it into a variable, used to read software release number from
version.php.

index.php: removed session storing of "database" config keyword since
it's not anymore in config file.
Now this file makes a check between version.php and release version
stored in configuration INI file. If they mismatch, the script will
automatically update INI file with release number stored in version.php.

install.php: updated call to version.php file with dirname(__FILE__) to
get current path. Deleted all reference to "database" config keyword.
Updated reference to config file reading path with dirname() when
writing down it. The call to version.php is now performed through
cs_ReadFile() function.

CrisoftRicette.ini.php: removed "database" keyword since it's superseded
by "dbname" one.

6.11.2002

recipe.php: links to mail pdf/printer friendly/cookbook/shopping list
have been put into a table.
Link to cookbook has been changed into a form button.

Deleted from package all cookbook_*.php files no more useful for
application.

cookbook.php: merged into this file all cookbook_*.php files. Link to
delete recipe from cookbook has been changed into a form button.

Deleted from package all insert_*php file no more useful for application.

insert.php: merged into this file all insert_*.php files. Link to insert
recipe without images/videos has been changed into a form button.

5.11.2002

All calls to CrisoftLib.php, includes/db_connection*.php and ini file
are now made with require() instead of include(), and using (dirname(__FILE__))
to get pathname.

install.php: removed all warnings caused by undefined constants.
Removed alphanumeric check of $_POST['db_name'] in order to allow the use of
an underscore in the database name: by the way, this field is always
checked against malicious characters often used for exploits.

4.11.2002

Code cleanup: removed some unuseful code from all scripts.

shoppinglist.php: added a missing html anchor closing tag for "added to
shopping list" link.

install.php: further modifications to include() functions: now it's done
with include(dirname(__FILE__)."/CrisoftLib.php");
It should be tested with safe_mode on

install.php: tried to modify include() with path name extracted with
dirname() from $_SERVER['SCRIPT_FILENAME']


v. 1.0pre5 released on 4.11.2002
--------------------------------
3.11.2002

Started a non-gettext branch, useful for php installation without
gettext functions. This branch has all I18N code removed and is only in
english language. No internationalization will be available for
non-gettext releases.

install.php: software version is now read from version.php and written
to configutatin file.

version.php: added this new file to store software version number.

recipe.php: link to rate.php page moved near number of votes got from
the recipe text.

README: some updates to reflect new installation process.

includes/db_connection.inc.php: modified to get the database name from
session variables.

index.php: the new dbname INI keyword is loaded into session variables.
Small cosmetic changes in the html output.

install.php: added a field to insert database name in configuration
form. ricette is the default value. The routine that writes config file
has been updated to reflect this change.
Now the script takes the database name from the input form and checks
for existance of a database with the same name. If found, it checks for
existance of tables and creates them if do not exist with two new
functions: cs_TableExists() and cs_DefaultData().


CrisoftLib.php: added two nef functions, cs_TableExists() (checks for 
existance of a table and creates it if not exists) and cs_DefaultData() 
(inserts default data required by application into newly created table).

Added a new configuration variable: dbname
This variable will store the database name defined during installation
process.


31.10.2002
README: modified readme file in order to reflect the new installation
process.

recipe.php: the "printer friendly version" link will be always
displayed, even if PDF generation is available.

shoppinglist.php: coding of shopping list feature completed. Now you can
add and delete recipes to shopping list, and print the complete list.

install.php: corrected recipe field in shopping table: it's now a VARCHAR field
instead of (wrong) INT. 

30.10.2002

recipe.php: added a link to shoppinglist.php.

shoppinglist.php: created the page that will manage shopping list.
Actually empty.

CrisoftRicette.sql file has been removed since database creation is
performed automatically during installation.

cookbook.php: moved a <p> tag previously outside from a while condition
inside of it, since all entries of the cookbook were printed on a single
line 

index.php: removed cs_CheckForPdf() function since the link to pdf file
is printed only if PDF functions are available.

install.php: added cs_CheckForGettext() function. PHP version checking
routine moved from index.php. Changed the path to config file, using
dirname() on $_SERVER['SCRIPT_FILENAME'] instead of
$_SERVER['DOCUMENT_ROOT'] in order to prevent possible problems if
software is installed in a subdirectory of already existing and
configured websites.
Install page now creates the database and all required tables,
populating them with default values. No need to run mysql to create
database/tables anymore.

CrisoftLib.php: added cs_CheckForGettext() function to check for available
gettext functions in PHP installation. If functions are not available
program is terminated with error message.


v. 1.0pre4 released on 28.10.2002
--------------------------------
27.10.2002
mail.php: ingredients, description and notes are now wordwrapped at 72
characters, in order to avoid breaking of email standards.
Added a signature with software download link.

CrisoftLib.php: added cs_CheckEmptyValue() function to check for
empty required fields in installation form.

install.php: if webserver can't write to config directory, configuration
file is displayed on screen and should pasted'n'copied into
config/CrisoftRicette.ini.php

26.10.2002
mail.php: created new page to send a recipe to a friend through email.
Mailing now works (even if the scripts needs more fine tuning).
It needs a working SMTP server to send emails, since it's based on PHP
mail() function.

cookbook_add.php: added a duplicate check function in order to avoid
duplicate insertion of the same recipe, even if on recipe.php the link
to cookbook_add.php is not displayed if recipe is already in personal
cookbook.

index.php: modified to reflect the new location of configuration file
under config/ subdirectory.

install.php: all configuration form value are checked in order to avoid
possible variable tampering or trivial exploits.
includes/db_connection.inc.php: fixed a typo on variable syntax of
connection string

CrisoftLib.php: added cs_CheckDangerousInput() to check form input fields 
for dangerous characters.
Added cs_CheckEmailAddress() to check for invalid email address. This
function DOES NOT check for real email address, but only for its
correctness.

24.10.2002
config/: created a chmod 777 config directory to store the new
configuration file. CrisoftRicette.ini.php  will be moved into this new
directory and will be written down by install.php
Note that 777 mode for directory has no meaning under Windows since
directory is always writable for webserver.

install.php: page populated with a form where the user should insert
configuration parameters. Inserted a security check with a hidden post
variable: if tampered program aborts with error.

16.10.2002
install.php: added this file that should take care of installation
process, in order to avoid manually editing of .ini file. Actually
empty.

index.php: added a check for existance of ini file, if does not exist
install.php will be displayed.

CrisoftLib.php: added cs_AddInstallheader() function to print a custom
header for install.php

10.10.2002
CrisoftLib.php: added cs_CheckForBrowseType() function, needed to check
for tampered _GET variable used to choose browsing method.

browse.php: added a list with different links to choose method to browse
database. It's now possible to browse recipes ordered by:
- id
- alphabet
- main ingredient
- dish
- kind of cooking
- season
- origin
- difficulty (starting from easiest and from most difficult)


v. 1.0pre3 released on 4.10.2002
--------------------------------

3.10.2002
All functions renamed to a better coding style: cs_FunctionName()

2.10.2002
Added a temp/ subdirectory (will be used for thumbnail generation)

30.09.2002
includes/header_error.inc.php: new header file added used only in case
of error generated by index.php

CrisoftLib.php: added two new functions:
cs_AddErrorHeader() to add a custom header in case of a configuration
error detected in index.php
cs_CheckForPageSize() to check for valid PDF page size

Crisoft.ini.php: added a new configuration variable: page_size needed to
control page size for PDF generation.

recipe_pdf.php now generates a PDF file of a selected recipe. BTW some
features are missing from it. When finished it should print also the
available image (if any) even if in reduced size, and asterisks instead
of degree of difficulty.

CrisoftLib.php: cs_check_for_pdf was modified with the use of function_exists()

recipe.php: link to pdf was modified with the use of function_exists()

29.09.2002
Added recipe-pdf.php file. This file should generate a PDF file of
selected recipe, in order to have a better printing of the recipe.
The file will be displayed through configured helper application (if
any) or prompted for downloading/saving to disk.

Added recipe-print.php file. This file will show a printer friendly
version (without header/footer) in order to print a recipe on your
printer without any "disturbing" things. This file will be available
only if PDF functions are not available.

Added two new classes in CrisoftRicette.css file: small and mandatory.

28.09.2002

insert_preview.php has now a check for  following fields: recipe name,
main ingredient, ingredients, description, dish type, cooking type and 
difficulty. Program aborts if even only one of those four fields was 
left empty.

insert.php now has in all drop down select a meaningful text of what to
do. For cooking type and difficulty grade there is also an option that
assing a null value "-" in order to insert the recipe even if you don't
want to assign a value to this field.

insert_images.php now checks for input images, aborting if not
jpg/gif/bmp/tif/png. File is fully working.


21.09.2002

insert_preview.php: code to insert a video was commented since
it seems that for .avi files PHP leaves out some predefined _FILES
variables, and for .mpg files _FILES variables don't exist at all.
Need further investigations.

insert_video.php added, even if actually broken.

insert_image.php has now a check on filename in order to avoit trivial
exploits.

Added a routine to insert_image.php to check for duplicate filenames of
image.

20.09.2002

Configuration keyword
installation_path
was removed, since a better way to find where upload images/videos was
found, getting from _SERVER variables actual path of the script and
extracting directory name with dirname().

If available, image of the recipe is printed immediately below recipe
title.

File insert_image.php added. It inserts data of the recipe and the image
name into the database, uploading image in images/ subdir.

Subdirectories images and video chmoded to 777 (only for Unix) in order
to permit upload of images and videos.

19.09.2002
New configuration option:
installation_path
it requires location on disc of installation path of CrisoftRicette
and it's used to upload images/videos.

A form to insert videoclip and image during insert a recipe stage has
been added in file insert_preview.php.


v. 1.0pre2 released on 19.09.2002
---------------------------------
New features implemented:
rating system
personal cookbook

Detailed changelog:

18.09.2002
Fixed warning of undefined index for $_GET['offset'] in browse.php.

recipe.php page has now a link to cookbook_add.php to insert displayed
recipe into personal cookbook only if the recipe is not already into
cookbook. If the recipe exists into cookbook it displays a message in
red.

cookbook_add.php/cookbook.php/cookbook_delete.php have been created to 
store and delete recipes into/from your personal cookbook table

personal_book and rating tables have an uncorrect parameter in SQL syntax 
creation for id field: it should be UNSIGNED_ZEROFILL. This has been fixed.

Rating feature in recipe.php has been modified in order to fix a
"division by zero" error. If a recipe has never been voted now it
displays it, and only if it got votes it displays number of votes and 
average vote.

17.09.2002
rate.php and rated.php added, and recipe.php modified. Now rating system
is fully working. The reader can rate a recipe, and number of votes +
average vote is displayed on recipe.php.


v. 1.0pre1 released on 17.09.2002
---------------------------------

Initial version 1.0preXXX release.
It's only possible to insert a recipe (with no images and/or videoclips
at all) and browse the unsorted database.
